import{g as e}from"./main-BXzC0iys.js";import"https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/10.3.0/firebase-auth.js";import"https://www.gstatic.com/firebasejs/10.3.0/firebase-firestore.js";function t(t,n,a,l=!1){const r=document.getElementById("print-target-iframe");r&&document.body.removeChild(r);const i=document.createElement("iframe");i.style.position="fixed",i.style.right="0",i.style.bottom="0",i.style.width="0",i.style.height="0",i.style.border="0",document.body.appendChild(i);const o=i.contentWindow.document,d=function(e,t,n,a,l){const r=new Date(e.updatedAt).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),i=e.id||"SIN-ID";let o="";o=l?`\n        <div class="flex justify-between items-end border-b-2 border-slate-800 pb-2 mb-4">\n            <div class="flex items-center gap-3">\n                <div class="text-xl w-10 h-10 flex items-center justify-center rounded-lg bg-slate-100 text-slate-700">\n                    ${t.icon||'<i class="fas fa-file"></i>'}\n                </div>\n                <div>\n                    <h1 class="text-xl font-bold text-slate-900 leading-none">${e.title}</h1>\n                    <p class="text-xs text-slate-500 mt-1 uppercase font-bold tracking-wider">${t.name}</p>\n                </div>\n            </div>\n            <div class="text-right text-[10px] text-slate-400">\n                <p>Actualizado: ${r}</p>\n                <p>ID: ${i.substring(0,8)}</p>\n            </div>\n        </div>`:`\n        <div class="relative overflow-hidden mb-8 rounded-3xl border border-slate-100 shadow-sm print:shadow-none">\n             <div class="absolute inset-0 opacity-10" style="background-color: ${t.color||"#3b82f6"}"></div>\n             <div class="absolute top-0 left-0 w-full h-1.5" style="background-color: ${t.color||"#3b82f6"}"></div>\n             \n             <div class="relative z-10 flex gap-6 items-start p-8">\n                <div class="flex-shrink-0 w-20 h-20 rounded-2xl flex items-center justify-center text-4xl shadow-md bg-white" style="color: ${t.color||"#3b82f6"}">\n                    ${t.icon||'<i class="fas fa-file"></i>'}\n                </div>\n                <div>\n                   <h1 class="text-3xl font-extrabold text-slate-800 tracking-tight leading-tight mb-2">${e.title}</h1>\n                   <div class="flex flex-wrap items-center gap-3 text-sm">\n                      <span class="inline-flex items-center px-2.5 py-0.5 rounded-lg font-bold text-xs uppercase tracking-wide bg-white/60 border border-slate-200/50 text-slate-600 backdrop-blur-sm">${t.name}</span>\n                      <span class="text-slate-500 flex items-center text-xs"><i class="far fa-clock mr-1.5"></i> ${r}</span>\n                      <span class="text-slate-400 text-[10px] font-mono">ID: ${i}</span>\n                   </div>\n                </div>\n             </div>\n        </div>`;const d=l?"grid-cols-4 gap-x-4 gap-y-2":"grid-cols-2 gap-6";let c=`\n        ${o}\n        <div class="grid ${d}">\n    `;t.fields.forEach(e=>{const t=n[e.id];let r="col-span-1";const i=["separator","table","text","textarea"].includes(e.type);if(r=l?i?"col-span-4":"col-span-1":i?"col-span-2":"col-span-1","separator"===e.type){return void(c+=`\n                <div class="${r} ${l?"mt-4 border-b border-slate-300 pb-1 mb-1 text-sm":"mt-6 border-b border-slate-200 pb-2 mb-2 text-lg"} page-break">\n                    <h3 class="font-bold text-slate-800 uppercase tracking-tight flex items-center gap-2">\n                        ${l?"":'<div class="w-1.5 h-6 bg-slate-400 rounded-full"></div>'} \n                        ${e.label}\n                    </h3>\n                </div>`)}if("table"===e.type)return void(c+=`<div class="${r}">${function(e,t,n,a){if(!Array.isArray(t)||0===t.length)return a?"":'<div class="p-4 border border-dashed border-slate-200 rounded-xl bg-slate-50 text-center text-xs text-slate-400 flex flex-col items-center gap-2"><i class="fas fa-table text-xl opacity-20"></i>Tabla vacía</div>';const l=a?"px-2 py-1":"px-4 py-2",r=a?"text-[10px]":"text-xs",i=a?"text-[11px]":"text-sm text-slate-600",o=e.columns.map(e=>`<th class="${l} text-left ${r} font-bold text-slate-400 uppercase tracking-wider border-b border-slate-200 bg-slate-50">${e.label}</th>`).join(""),d=t.map(t=>`<tr class="page-break">${e.columns.map(e=>`<td class="${l} ${i} border-b border-slate-50 align-top">${s(e.type,t[e.id],n,a)}</td>`).join("")}</tr>`).join("");return`\n        <div class="mt-2 mb-2 page-break">\n            ${a?"":`<div class="flex items-center mb-2 gap-2"><label class="text-xs font-bold text-slate-400 uppercase"><i class="fas fa-table"></i> ${e.label}</label></div>`}\n            <div class="border border-slate-200 ${a?"rounded":"rounded-xl"} overflow-hidden bg-white">\n                <table class="min-w-full w-full">\n                    <thead><tr>${o}</tr></thead>\n                    <tbody>${d}</tbody>\n                </table>\n            </div>\n        </div>`}(e,t,a,l)}</div>`);const o=s(e.type,t,a,l);c+=l?`\n            <div class="${r} border-b border-slate-200 py-1 page-break">\n              <dt class="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1">${e.label}</dt>\n              <dd class="text-xs font-semibold text-slate-900 whitespace-pre-wrap leading-tight mt-0.5">${o}</dd>\n            </div>`:`\n            <div class="${r} bg-slate-50 rounded-xl px-4 py-2 border border-slate-100 page-break">\n              <dt class="text-xs font-bold text-slate-400 uppercase tracking-wide mb-1 flex items-center gap-2">\n                 ${e.label}\n              </dt>\n              <dd class="text-sm text-slate-800 break-words leading-relaxed font-medium">\n                 ${o}\n              </dd>\n            </div>`}),c+="</div>",l||(c+='\n        <div class="mt-8 pt-4 border-t border-slate-100 flex items-center justify-between">\n           <div class="flex items-center text-slate-400 text-xs font-bold uppercase tracking-wider">\n                <i class="fas fa-shield-alt mr-2"></i> Documento Confidencial\n           </div>\n           <div class="text-slate-300 text-[10px]">Generado por Mi Gestión</div>\n        </div>');return c}(t,n,a,e(),l);o.open(),o.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <title>${t.title}</title>\n            <script src="https://cdn.tailwindcss.com"><\/script>\n            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">\n            <style>\n                @media print {\n                    /* Márgenes: Compacto = 1cm, Estándar = 1.5cm */\n                    @page { margin: ${l?"1cm":"1.5cm"}; size: auto; }\n                    body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }\n                    .page-break { break-inside: avoid; }\n                }\n                body { \n                    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;\n                    padding: 20px; \n                    background-color: white;\n                }\n            </style>\n        </head>\n        <body>\n            ${d}\n            <script>\n                window.onload = () => {\n                    setTimeout(() => {\n                        window.print();\n                        // window.parent.document.body.removeChild(window.frameElement);\n                    }, 800);\n                };\n            <\/script>\n        </body>\n        </html>\n    `),o.close()}function s(e,t,s,n){if(null==t||""===t)return n?"—":'<span class="text-slate-300 italic text-xs">Vacío</span>';if("object"==typeof t&&t.url){if("url"===e&&t.url.match(/\.(jpeg|jpg|gif|png|webp)$/i)){const e=n?"text-[10px]":"text-sm";return`<div class="flex items-center gap-3">\n                        <div class="relative rounded-lg overflow-hidden border border-slate-200 shadow-sm bg-slate-50 ${n?"w-8 h-8":"w-12 h-12"} flex-shrink-0">\n                            <img src="${t.url}" class="w-full h-full object-cover">\n                        </div>\n                        <span class="${e} font-bold text-slate-700 break-words">${t.text||"Imagen"}</span>\n                     </div>`}const s=t.text||t.url,a=t.url;return s===a?`<div class="${n?"text-[10px]":"text-sm"} text-slate-600 break-all font-mono">${a}</div>`:`\n        <div class="flex flex-col">\n            <span class="${n?"text-xs font-bold text-slate-800":"text-sm font-bold text-slate-800"} leading-tight">${s}</span>\n            <span class="${n?"text-[9px] text-slate-400":"text-[10px] text-slate-400"} break-all font-mono mt-0.5 leading-tight">${a}</span>\n        </div>`}switch(e){case"boolean":return t?'<span class="inline-flex items-center gap-1 font-bold text-emerald-700 text-xs"><i class="fas fa-check"></i> Sí</span>':'<span class="inline-flex items-center gap-1 font-bold text-slate-500 text-xs">No</span>';case"currency":return`<span class="font-mono font-bold text-slate-800 bg-slate-100 px-1.5 py-0.5 rounded text-xs border border-slate-200 inline-block">${new Intl.NumberFormat(s.locale,{style:"currency",currency:s.codigo}).format(Number(t))}</span>`;case"percentage":return`<span class="font-mono font-bold text-slate-800">${t}%</span>`;case"date":try{const[e,s,n]=String(t).split("-");return`<span class="font-bold text-slate-700 flex items-center gap-1.5"><i class="far fa-calendar text-slate-400 text-xs"></i> ${n}/${s}/${e}</span>`}catch(a){return t}case"text":case"textarea":return`<div class="whitespace-pre-line text-slate-700 ${n?"text-xs":"text-sm"}">${t}</div>`;default:return String(t)}}export{t as printDocument};
